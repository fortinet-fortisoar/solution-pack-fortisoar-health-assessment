{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "> Create MD for Description",
    "aliasName": null,
    "tag": null,
    "description": "This playbook generates a report that is displayed in the Health Assessment module.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "fortisoar_health_data",
        "recommendations_only"
    ],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/dbf8de0d-974b-451d-bbbc-8d4e2ec77ec4",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/5886c158-3ecd-4136-a75a-5282a3deb3ab",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Alerts Creation Trend",
            "description": null,
            "arguments": {
                "when": "{{not vars.input.params['recommendations_only']}}",
                "params": {
                    "data": "{% set data ={\"Per Day\":vars.input.params['fortisoar_health_data']['fortisoar_information']['number_of_alerts_created_in_one_day'], \"Per Week\":vars.input.params['fortisoar_health_data']['fortisoar_information']['number_of_alerts_created_in_one_week'],\"Per Two Weeks\":vars.input.params['fortisoar_health_data']['fortisoar_information']['number_of_alerts_created_in_two_week']} %}{{ data | toDict}}",
                    "display": "Horizontal",
                    "styling": true,
                    "row_fields": "",
                    "show_button": true,
                    "table_style": "{{vars.css}}"
                },
                "version": "3.5.0",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "420",
            "left": "420",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "819e713d-a13a-457f-8fa4-3805fc9ad634"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Generatting Recommendations Only",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "for Health Assessment",
                        "step_iri": "\/api\/3\/workflow_steps\/f97556de-70e6-47d4-a84e-bcf6880b7063",
                        "condition": "{{ not vars.input.params['recommendations_only'] }}",
                        "step_name": "Report Generator Snippet For Assessment"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "540",
            "left": "740",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "8e22e053-fe50-40bc-98fa-0f9d3fd45b63"
        },
        {
            "@type": "WorkflowStep",
            "name": "Most Executed Playbooks",
            "description": null,
            "arguments": {
                "when": "{{not vars.input.params['recommendations_only']}}",
                "params": {
                    "data": "{% set data=[] %}{% for temp in vars.input.params['fortisoar_health_data']['fortisoar_information'][\"top_10_most_executed_playbooks\"] %}\n{% do  data.append({\"Playbook Name\":temp['playbook_name'],\"Execution Count\":temp['execution_count']}) %}{% endfor %}{{data}}",
                    "display": "Horizontal",
                    "styling": true,
                    "row_fields": "",
                    "show_button": true,
                    "table_style": "{{vars.css}}"
                },
                "version": "3.5.0",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "ignore_errors": true,
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "500",
            "left": "420",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "538aecae-437d-4244-8fc6-217e8f979798"
        },
        {
            "@type": "WorkflowStep",
            "name": "Most Failing Playbooks",
            "description": null,
            "arguments": {
                "when": "{{not vars.input.params['recommendations_only']}}",
                "params": {
                    "data": "{% set data=[] %}{% for temp in vars.input.params['fortisoar_health_data']['fortisoar_information'][\"top_10_most_failing_playbooks\"] %}\n{% do  data.append({\"Playbook Name\":temp['playbook_name'],\"Execution Count\":temp['execution_count']}) %}{% endfor %}{{data}}",
                    "display": "Horizontal",
                    "styling": true,
                    "row_fields": "",
                    "show_button": true,
                    "table_style": "{{vars.css}}"
                },
                "version": "3.5.0",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "ignore_errors": true,
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "580",
            "left": "420",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "4cba893e-2e99-477f-9632-a81744cc96f0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Most Time Consuming Playbooks",
            "description": null,
            "arguments": {
                "when": "{{not vars.input.params['recommendations_only']}}",
                "params": {
                    "data": "{% set data=[] %}{% for temp in vars.input.params['fortisoar_health_data']['fortisoar_information'][\"top_10_most_time_consuming_playbooks\"] %}{% set timestamp = temp['time_consumed'] %}{% set time_parts = timestamp.split('.') %}{% set time = time_parts[0] %}{% set milliseconds = time_parts[1] if time_parts|length > 1 else '' %}{% set hours, minutes, seconds = time.split(':') %}{% set time_string = (hours | string) + ' hr, ' if hours | int > 0 else '' %}{% set time_string = time_string+(minutes | string) + ' min, ' if minutes | int > 0 else '' %}{% set time_string = time_string+(seconds | string) + ' sec, ' if seconds | int > 0 else '' %}{% set time_string = time_string+ (milliseconds | string) + ' ms. ' if milliseconds | int > 0 else '' %}{% do  data.append({\"Playbook Name\":temp['playbook_name'],\"Time Consumed\":time_string}) %}{% endfor %}{{data}}",
                    "display": "Horizontal",
                    "styling": true,
                    "row_fields": "",
                    "show_button": "",
                    "table_style": "{{vars.css}}"
                },
                "version": "3.5.0",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "ignore_errors": true,
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "660",
            "left": "420",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "fe1373a8-2f8a-4299-b422-00f370cd9240"
        },
        {
            "@type": "WorkflowStep",
            "name": "Other Configurations",
            "description": null,
            "arguments": {
                "params": {
                    "data": "{% set data = [] %}{% do data.append({\"Configuration For\": \"celeryd\",\"Parameter\":\"CELERYD_OPTS\",\"File Path\":\"\/etc\/celery\/celeryd.conf\",\"Current Value\": vars.input.params['fortisoar_health_data'].current_system_configuration.celeryd,\"Recommended Value\":vars.input.params['fortisoar_health_data'].recommended_configuration.celeryd}) %}{% do data.append({\"Configuration For\": \"sealab_wsgi\",\"Parameter\":\"processes\",\"File Path\":\"\/etc\/uwsgi.d\/sealab_wsgi.ini\",\"Current Value\": vars.input.params['fortisoar_health_data'].current_system_configuration.sealab_wsgi,\"Recommended Value\":vars.input.params['fortisoar_health_data'].recommended_configuration.sealab_wsgi}) %}{% do data.append({\"Configuration For\": \"integrations_wgsi\",\"Parameter\":\"processes\",\"File Path\":\"\/etc\/uwsgi.d\/integrations_wgsi.ini\",\"Current Value\": vars.input.params['fortisoar_health_data'].current_system_configuration.integrations_wgsi,\"Recommended Value\":vars.input.params['fortisoar_health_data'].recommended_configuration.integrations_wgsi}) %}{% do data.append({\"Configuration For\": \"RabbitMQ\",\"Parameter\":\"RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS\",\"File Path\":\"\/etc\/rabbitmq\/rabbitmq-env.conf\",\"Current Value\": vars.input.params['fortisoar_health_data'].current_system_configuration.rabbit_mq,\"Recommended Value\":vars.input.params['fortisoar_health_data'].recommended_configuration.rabbit_mq}) %}{{data}}",
                    "display": "Horizontal",
                    "styling": true,
                    "row_fields": "",
                    "show_button": true,
                    "table_style": "{{vars.css}}"
                },
                "version": "3.5.0",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "340",
            "left": "360",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "e8876044-d453-4ed8-9373-d3ada54d81c7"
        },
        {
            "@type": "WorkflowStep",
            "name": "Output MD",
            "description": null,
            "arguments": {
                "assessment_report": "{{\"<h2>System Performance & Operational Assessment Overview <\/h2>\n\n-  **Comprehensive Evaluation :** Analyzes system performance and efficiency, offering detailed insights into configuration and performance metrics.\n- **Alert Trends** : Tracks alert patterns over time, identifying recurring issues (e.g., 15% of alerts are repeated weekly).\n-  **Playbook Insights**:\n     -  **Top Playbooks**: Identifies the most executed playbooks, revealing common tasks \n     -  **Troubleshooting Focus**: Highlights failing playbooks \n     - **Optimization Opportunities**: Analyzes time-consuming playbooks\n     - **Debug Mode Monitoring**: Tracks playbooks constantly running in debug mode, indicating possible inefficiencies or new playbook development\" if vars.health_assessment_snippet else \"\n<h2>System Resources Overview <\/h2>\n\n- **Key Metrices Captured :**\n    - **vCPU** : Number of virtual CPUs allocated to the system.\n    - **RAM** : Total memory allocated to the system.\n    - **Disk Latency** : Time taken for data transfer between storage and CPU\n    - **IOPS (Read\/Write)** : Rate of read and write operations on the disk\n\"}}\n\n<h2> System Resources <\/h2>\n\n<hr \/>\n<div  >\n    {{vars.steps.System_Details.data}}\n<\/div>\n\n\n{{\"<h2> FortiSOAR Details <\/h2>\n\n* * *\" if vars.health_assessment_snippet}}\n\n{{vars.health_assessment_snippet if vars.health_assessment_snippet}}",
                "recommendation_report": "{{vars.recommendation_snippet}}"
            },
            "status": null,
            "top": "620",
            "left": "1140",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "825adbdd-ef88-4ff5-973c-ced63747eb5b"
        },
        {
            "@type": "WorkflowStep",
            "name": "PHP FPM",
            "description": null,
            "arguments": {
                "params": {
                    "data": "{% set data = [] %}{% do data.append({\"Configuration For\": \"php_fpm\",\"Parameter\":\"pm.start_servers\",\"File Path\":\"\/etc\/php-fpm.d\/cyops-api.conf\",\"Current Value\": vars.input.params['fortisoar_health_data']['current_system_configuration']['php_fpm']['pm.start_servers'],\"Recommended Value\":vars.input.params['fortisoar_health_data']['recommended_configuration']['php_fpm']['pm.start_servers']}) %}{% do data.append({\"Configuration For\": \"php_fpm\",\"Parameter\":\"pm.max_spare_servers\",\"File Path\":\"\/etc\/php-fpm.d\/cyops-api.conf\",\"Current Value\": vars.input.params['fortisoar_health_data']['current_system_configuration']['php_fpm']['pm.max_spare_servers'],\"Recommended Value\":vars.input.params['fortisoar_health_data']['recommended_configuration']['php_fpm']['pm.max_spare_servers']}) %}{% do data.append({\"Configuration For\": \"php_fpm\",\"Parameter\":\"pm.max_children\",\"File Path\":\"\/etc\/php-fpm.d\/cyops-api.conf\",\"Current Value\": vars.input.params['fortisoar_health_data']['current_system_configuration']['php_fpm']['pm.max_children'],\"Recommended Value\":vars.input.params['fortisoar_health_data']['recommended_configuration']['php_fpm']['pm.max_children']}) %}{{data}}",
                    "display": "Horizontal",
                    "styling": true,
                    "row_fields": "['Parameter','Current Value','Recommended Value']",
                    "show_button": true,
                    "table_style": "{{vars.css}}"
                },
                "version": "3.5.0",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "260",
            "left": "360",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "adcea734-fb98-4ae1-a75e-ee944a9eee31"
        },
        {
            "@type": "WorkflowStep",
            "name": "Playbooks Constantly Running In Debug Mode",
            "description": null,
            "arguments": {
                "when": "{{not vars.input.params['recommendations_only']}}",
                "params": {
                    "data": "{% set data=[] %}{% for temp in vars.input.params['fortisoar_health_data']['fortisoar_information'][\"top_10_playbooks_running_in_debug_mode\"] %}\n{% do  data.append({\"Playbook Name\":temp['playbook_name'],\"Execution Count\":temp['execution_count']}) %}{% endfor %}{{data}}",
                    "display": "Horizontal",
                    "styling": true,
                    "row_fields": "",
                    "show_button": true,
                    "table_style": "{{vars.css}}"
                },
                "version": "3.5.0",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "ignore_errors": true,
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "740",
            "left": "420",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "c39e0e80-394c-4b13-861f-123893dd4d47"
        },
        {
            "@type": "WorkflowStep",
            "name": "Postgre SQL",
            "description": null,
            "arguments": {
                "params": {
                    "data": "{% set data = [] %}{% for value in ['work_mem','wal_buffers','max_wal_size','min_wal_size','shared_buffers','max_connections','random_page_cost','effective_cache_size','maintenance_work_mem','max_parallel_workers','max_worker_processes','effective_io_concurrency','checkpoint_completion_target','max_parallel_workers_per_gather','max_parallel_maintenance_workers']%}{% do data.append({\"Configutation For\": \"postgresql\",\"Parameter\":value,\"File Path\":\"\/var\/lib\/pgsql\/14\/data\/postgresql.conf\",\"Current Value\": vars.input.params['fortisoar_health_data']['current_system_configuration']['postgresql'][value],\"Recommended Value\":vars.input.params['fortisoar_health_data']['recommended_configuration']['postgresql'][value]}) %}{% endfor %}{{data}}",
                    "display": "Horizontal",
                    "styling": true,
                    "row_fields": "['Parameter','Current Value','Recommended Value']",
                    "show_button": true,
                    "table_style": "{{vars.css}}"
                },
                "version": "3.5.0",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "180",
            "left": "360",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "46ea0c94-d53c-427a-9d27-73b82bf355ca"
        },
        {
            "@type": "WorkflowStep",
            "name": "Report Generator Snippet For Assessment",
            "description": null,
            "arguments": {
                "health_assessment_snippet": "<div  >\n    <table style=\"display: inline-block; border: none;\">\n        <tr style=\"display:flex\">\n            <td style=\"flex:1\" colspan='2'>\n                <h3>Alerts Trend : Number of Alerts Ingested<\/h3>\n                <\/br>\n                <div  >\n                    {{vars.steps.Alerts_Creation_Trend.data if\n                    (vars.input.params['fortisoar_health_data']['fortisoar_information']['number_of_alerts_created_in_one_day']\n                    | int !=0)\n                    or(vars.input.params['fortisoar_health_data']['fortisoar_information']['number_of_alerts_created_in_one_week']\n                    | int !=0)\n                    or(vars.input.params['fortisoar_health_data']['fortisoar_information']['number_of_alerts_created_in_two_week']\n                    | int !=0) else \"<div  ><div style='background-color: #e9ecef; color: #6c757d; padding: 10px; border: 1px solid #ced4da;'>No data is available to display at the moment.<\/div>\"}}\n                <\/div>\n            <\/td>\n        <\/tr>\n        <tr style=\"display:flex\">\n            <td style=\"flex:1\">\n                <h3>Playbook : Most Executed<\/h3>\n                <\/br>\n                <div  >\n                    {{vars.steps.Most_Executed_Playbooks.data if\n                    (vars.input.params['fortisoar_health_data']['fortisoar_information']['top_10_most_executed_playbooks']|\n                    length) != 0 else \"<div  ><div style='background-color: #e9ecef; color: #6c757d; padding: 10px; border: 1px solid #ced4da;'>No data is available to display at the moment.<\/div>\"}}\n                <\/div>\n            <\/td>\n            <td style=\"flex:1\">\n                <h3>Playbook : Most Failing<\/h3>\n                <\/br>\n                <div  >\n                    {{vars.steps.Most_Failing_Playbooks.data if\n                    (vars.input.params['fortisoar_health_data']['fortisoar_information']['top_10_most_failing_playbooks']|\n                    length) != 0 else \"<div  ><div style='background-color: #e9ecef; color: #6c757d; padding: 10px; border: 1px solid #ced4da;'>No data is available to display at the moment.<\/div>\"}}\n                <\/div>\n            <\/td>\n        <\/tr>\n        <tr style=\"display:flex\">\n            <td style=\"flex:1\">\n                <h3>Playbook : Running In Debug Mode<\/h3>\n                <br \/>\n                <div>\n                    {{vars.steps.Playbooks_Constantly_Running_In_Debug_Mode.data\n                    if(vars.input.params['fortisoar_health_data']['fortisoar_information']['top_10_playbooks_running_in_debug_mode']|\n                    length) != 0 else \"<div  ><div style='background-color: #e9ecef; color: #6c757d; padding: 10px; border: 1px solid #ced4da;'>No data is available to display at the moment.<\/div>\" }}\n                <\/div>\n            <\/td>\n            <td style=\"flex:1\">\n                <h3>Playbook : Most Time Consuming<\/h3>\n                <\/br>\n                <div  >\n                    {{vars.steps.Most_Time_Consuming_Playbooks.data if\n                    (vars.input.params['fortisoar_health_data']['fortisoar_information']['top_10_most_time_consuming_playbooks']|\n                    length) != 0 else \"<div  ><div style='background-color: #e9ecef; color: #6c757d; padding: 10px; border: 1px solid #ced4da;'>No data is available to display at the moment.<\/div>\" }}\n                <\/div>\n            <\/td>\n        <\/tr>\n    <\/table>\n<\/div>"
            },
            "status": null,
            "top": "440",
            "left": "740",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "f97556de-70e6-47d4-a84e-bcf6880b7063"
        },
        {
            "@type": "WorkflowStep",
            "name": "Report Snippet Generator For Recommendation",
            "description": null,
            "arguments": {
                "recommendation_snippet": "<h2>Key Recommendations for System Optimization <\/h2>\n\n- **PostgreSQL Configuration**: Adjust database settings for improved performance.\n- **Workflow Engine**: Fine-tune worker configurations for better task execution and to enhance request handling.\n- **PHP Application Optimization**: Adjust **php-fpm** settings to boost processing speed.\n- **Swap Space Configuration**: Ensure adequate swap space to maintain stability under heavy load.\n- **RabbitMQ Configuration**: Streamline message queuing to improve communication between services.\n<br>\n\n<h4><strong>Note:<\/strong> The configuration changes below will require all services to be restarted.<\/h4>\n<br>\n<div class=\"\">\n    <table style=\"display: inline-block; border: 0px solid black; margin: auto;\">\n        <tr style=\"display:flex\">\n            <td style=\"flex:1\">\n                <h3 >PostgreSQL<\/h3>\n                <h4 >Edit the <code>\/var\/lib\/pgsql\/16\/data\/postgresql.conf<\/code> file with the following parameters.<\/h4>\n                <div class=\"\">\n                    {{vars.steps.Postgre_SQL.data}}\n                <\/div>\n            <\/td>\n            <td style=\"flex:1\">\n                <h3 >PHP-FPM<\/h3>\n                <h4 >Edit the <code>\/etc\/php-fpm.d\/cyops-api.conf<\/code> file with the following parameters.<\/h4>\n                <div class=\"\">\n                    {{vars.steps.PHP_FPM.data}}\n                <\/div>\n            <\/td>\n        <\/tr>\n        <tr style=\"display:flex\">\n            <td colspan=\"2\" style=\"flex:1\">\n                <h3 >Workflow Engine and RabbitMQ<\/h3>\n                <br\/>\n                <div class=\"\">\n                    {{vars.steps.Other_Configurations.data}}\n                <\/div>\n                <br\/>\n                <h4><strong>Note :<\/strong>If you're still experiencing playbook queue buildup, we recommend increasing the value of <b>CELERYD_OPTS<\/b> to \"{{vars.input.params['fortisoar_health_data'].recommended_configuration.max_celeryd}}\".<br\/> This will improve task distribution and allow your system to handle larger queues more efficiently.<\/h4>\n                <br\/>\n            <\/td>\n        <\/tr>\n        <tr style=\"display:flex\">\n            <td colspan=\"2\" style=\"flex:1\">\n                <h3 >SWAP SPACE<\/h3>\n                <h4 >Use the <a href=\"https:\/\/docs.redhat.com\/en\/documentation\/red_hat_enterprise_linux\/9\/html\/managing_storage_devices\/getting-started-with-swap_managing-storage-devices#creating-a-swap-file_getting-started-with-swap\">documentation<\/a> for creating swap space<\/h4>\n                <div class=\"\">\n                    {{vars.steps.Swap_Space.data}}\n                <\/div>\n            <\/td>\n        <\/tr>\n    <\/table>\n<\/div>"
            },
            "status": null,
            "top": "220",
            "left": "780",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "d1a8c84a-d8ee-441d-9134-efa9ed429a67"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "__triggerLimit": true,
                "step_variables": {
                    "css": "{\"table\":\"width: 80%;margin: 20px auto;border-collapse: collapse;\",\"th\":\"border: 2px solid #080808;padding: 8px;word-break: break-word !important;text-wrap-mode: wrap;\",\"td\":\"border: 2px solid #080808;padding: 8px;word-break: break-word !important;text-wrap-mode: wrap;\",\"thead\":\"background-color: #5074e2;color: #fff;\"}",
                    "input": {
                        "params": []
                    }
                },
                "triggerOnSource": true,
                "triggerOnReplicate": false
            },
            "status": null,
            "top": "600",
            "left": "120",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "5886c158-3ecd-4136-a75a-5282a3deb3ab"
        },
        {
            "@type": "WorkflowStep",
            "name": "Swap Space",
            "description": null,
            "arguments": {
                "params": {
                    "data": "{% set data = [] %}{% do data.append({\"Current Value\": vars.input.params['fortisoar_health_data'].current_system_configuration.swap_space,\"Recommended Value\":vars.input.params['fortisoar_health_data'].recommended_configuration.swap_space}) %}{{data}}",
                    "display": "Horizontal",
                    "styling": true,
                    "row_fields": "",
                    "show_button": true,
                    "table_style": "{{vars.css}}"
                },
                "version": "3.5.0",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "100",
            "left": "360",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "5618acb3-2de3-4b4a-a780-89474e391a17"
        },
        {
            "@type": "WorkflowStep",
            "name": "System Details",
            "description": null,
            "arguments": {
                "params": {
                    "data": "{% set data=vars.input.params['fortisoar_health_data']['system_details'] %}{% set output={'vCPU':vars.input.params['fortisoar_health_data']['system_details']['CPU'],'RAM':vars.input.params['fortisoar_health_data']['system_details']['RAM']+' GB','Disk latency':vars.input.params['fortisoar_health_data']['system_details']['Disk latency'],'Disk IOPS - Read':vars.input.params['fortisoar_health_data']['system_details']['Disk IOPS - Read'],'Disk IOPS - Write':vars.input.params['fortisoar_health_data']['system_details']['Disk IOPS - Write']} %}{{output}}",
                    "display": "Horizontal",
                    "styling": true,
                    "row_fields": "",
                    "show_button": true,
                    "table_style": "{{vars.css}}"
                },
                "version": "3.5.0",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "840",
            "left": "420",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "6cfefc47-4be3-4fb6-bbf0-c263e6907755"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Alerts Creation Trend -> Check if Generatting Recommendations Only",
            "targetStep": "\/api\/3\/workflow_steps\/8e22e053-fe50-40bc-98fa-0f9d3fd45b63",
            "sourceStep": "\/api\/3\/workflow_steps\/819e713d-a13a-457f-8fa4-3805fc9ad634",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "d48a6662-54ae-4ee9-8935-721178a5d4e3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Generatting Recommendations Only -> Report Generator Snippet For Assessment",
            "targetStep": "\/api\/3\/workflow_steps\/f97556de-70e6-47d4-a84e-bcf6880b7063",
            "sourceStep": "\/api\/3\/workflow_steps\/8e22e053-fe50-40bc-98fa-0f9d3fd45b63",
            "label": "for Health Assessment",
            "isExecuted": false,
            "group": null,
            "uuid": "d8af4b2a-6f4d-4254-ace0-9c174cfb601a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Most Executed Playbooks -> Check if Generatting Recommendations Only",
            "targetStep": "\/api\/3\/workflow_steps\/8e22e053-fe50-40bc-98fa-0f9d3fd45b63",
            "sourceStep": "\/api\/3\/workflow_steps\/538aecae-437d-4244-8fc6-217e8f979798",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "656d2be2-1c3a-4eb7-8bf7-2aa5eca82903"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Most Failing Playbooks -> Check if Generatting Recommendations Only",
            "targetStep": "\/api\/3\/workflow_steps\/8e22e053-fe50-40bc-98fa-0f9d3fd45b63",
            "sourceStep": "\/api\/3\/workflow_steps\/4cba893e-2e99-477f-9632-a81744cc96f0",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "a06a1e0c-3371-4607-9704-88aa3097d4be"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Most Time Consuming Playbooks -> Check if Generatting Recommendations Only",
            "targetStep": "\/api\/3\/workflow_steps\/8e22e053-fe50-40bc-98fa-0f9d3fd45b63",
            "sourceStep": "\/api\/3\/workflow_steps\/fe1373a8-2f8a-4299-b422-00f370cd9240",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "561383c7-3781-4240-b73a-e64b8b0fbfd7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Other Configurations -> Report Snippet Generator",
            "targetStep": "\/api\/3\/workflow_steps\/d1a8c84a-d8ee-441d-9134-efa9ed429a67",
            "sourceStep": "\/api\/3\/workflow_steps\/e8876044-d453-4ed8-9373-d3ada54d81c7",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "ec26ffc1-fc94-4343-8893-ce09f262d344"
        },
        {
            "@type": "WorkflowRoute",
            "name": "PHP FPM -> Report Snippet Generator",
            "targetStep": "\/api\/3\/workflow_steps\/d1a8c84a-d8ee-441d-9134-efa9ed429a67",
            "sourceStep": "\/api\/3\/workflow_steps\/adcea734-fb98-4ae1-a75e-ee944a9eee31",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "673b659f-a0ee-4b6a-99e8-4c57e801543e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Playbooks Constantly Running In Debug Mode -> Check if Generatting Recommendations Only",
            "targetStep": "\/api\/3\/workflow_steps\/8e22e053-fe50-40bc-98fa-0f9d3fd45b63",
            "sourceStep": "\/api\/3\/workflow_steps\/c39e0e80-394c-4b13-861f-123893dd4d47",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "07e5b311-093e-4e3d-a9ee-57b27473ef8e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Postgre SQL -> Report Snippet Generator",
            "targetStep": "\/api\/3\/workflow_steps\/d1a8c84a-d8ee-441d-9134-efa9ed429a67",
            "sourceStep": "\/api\/3\/workflow_steps\/46ea0c94-d53c-427a-9d27-73b82bf355ca",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "ed06b34d-f5bb-43d3-b932-dd0d27787434"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Report Generator Snippet For Assessment -> Output MD",
            "targetStep": "\/api\/3\/workflow_steps\/825adbdd-ef88-4ff5-973c-ced63747eb5b",
            "sourceStep": "\/api\/3\/workflow_steps\/f97556de-70e6-47d4-a84e-bcf6880b7063",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "23cc0d5f-62f9-43cc-a3c6-efc1766da9c2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Report Snippet Generator -> Output MD",
            "targetStep": "\/api\/3\/workflow_steps\/825adbdd-ef88-4ff5-973c-ced63747eb5b",
            "sourceStep": "\/api\/3\/workflow_steps\/d1a8c84a-d8ee-441d-9134-efa9ed429a67",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "14761361-2bb8-4cd9-9f92-caac9b6cb4ec"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Alerts Trends",
            "targetStep": "\/api\/3\/workflow_steps\/819e713d-a13a-457f-8fa4-3805fc9ad634",
            "sourceStep": "\/api\/3\/workflow_steps\/5886c158-3ecd-4136-a75a-5282a3deb3ab",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "480f4fa3-7bbd-43ba-9336-8db84aa2193e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Most Executed Playbooks",
            "targetStep": "\/api\/3\/workflow_steps\/538aecae-437d-4244-8fc6-217e8f979798",
            "sourceStep": "\/api\/3\/workflow_steps\/5886c158-3ecd-4136-a75a-5282a3deb3ab",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "ce6040a3-c8c8-4591-8c70-14e9e504aaa2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Most Failing Playbooks",
            "targetStep": "\/api\/3\/workflow_steps\/4cba893e-2e99-477f-9632-a81744cc96f0",
            "sourceStep": "\/api\/3\/workflow_steps\/5886c158-3ecd-4136-a75a-5282a3deb3ab",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "11a3377e-1cee-43a0-83e1-909aa2c8f5f7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Most Time Consuming Playbooks",
            "targetStep": "\/api\/3\/workflow_steps\/fe1373a8-2f8a-4299-b422-00f370cd9240",
            "sourceStep": "\/api\/3\/workflow_steps\/5886c158-3ecd-4136-a75a-5282a3deb3ab",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "52e3dd35-3390-4630-88c1-2463a84d0228"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Other Configurations",
            "targetStep": "\/api\/3\/workflow_steps\/e8876044-d453-4ed8-9373-d3ada54d81c7",
            "sourceStep": "\/api\/3\/workflow_steps\/5886c158-3ecd-4136-a75a-5282a3deb3ab",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "fe111420-9e8b-40b7-8408-0696d28f64b1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> PHP FPM",
            "targetStep": "\/api\/3\/workflow_steps\/adcea734-fb98-4ae1-a75e-ee944a9eee31",
            "sourceStep": "\/api\/3\/workflow_steps\/5886c158-3ecd-4136-a75a-5282a3deb3ab",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "50b910a7-d61b-4dcc-9577-b6df8416781d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Playbooks Constantly Running In Debug Mode",
            "targetStep": "\/api\/3\/workflow_steps\/c39e0e80-394c-4b13-861f-123893dd4d47",
            "sourceStep": "\/api\/3\/workflow_steps\/5886c158-3ecd-4136-a75a-5282a3deb3ab",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "afd885cf-88f8-4bfc-ac90-d2d36a27159b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Postgre SQL",
            "targetStep": "\/api\/3\/workflow_steps\/46ea0c94-d53c-427a-9d27-73b82bf355ca",
            "sourceStep": "\/api\/3\/workflow_steps\/5886c158-3ecd-4136-a75a-5282a3deb3ab",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "0e75c235-a441-4bfd-80ce-973ed74ef9eb"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Stess",
            "targetStep": "\/api\/3\/workflow_steps\/6cfefc47-4be3-4fb6-bbf0-c263e6907755",
            "sourceStep": "\/api\/3\/workflow_steps\/5886c158-3ecd-4136-a75a-5282a3deb3ab",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "f44a6812-41cb-4d60-ae26-bad143fa500e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Swap Space",
            "targetStep": "\/api\/3\/workflow_steps\/5618acb3-2de3-4b4a-a780-89474e391a17",
            "sourceStep": "\/api\/3\/workflow_steps\/5886c158-3ecd-4136-a75a-5282a3deb3ab",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "dfef034f-90d5-48bf-962f-5f7eaedc5bf5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Swap Space -> Report Snippet Generator",
            "targetStep": "\/api\/3\/workflow_steps\/d1a8c84a-d8ee-441d-9134-efa9ed429a67",
            "sourceStep": "\/api\/3\/workflow_steps\/5618acb3-2de3-4b4a-a780-89474e391a17",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "4559539b-41a9-4eeb-9c12-7ceffa886ca5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "System Details -> Output MD",
            "targetStep": "\/api\/3\/workflow_steps\/825adbdd-ef88-4ff5-973c-ced63747eb5b",
            "sourceStep": "\/api\/3\/workflow_steps\/6cfefc47-4be3-4fb6-bbf0-c263e6907755",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b7ba5563-569f-4feb-9525-12e38bfa5894"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "2b5fda5c-eb00-4b41-be3e-f932df38a89a",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "FortiSOAR Health Assessment",
        "Referenced",
        "system"
    ]
}